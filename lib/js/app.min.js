!function(){"use strict";angular.module("baseAngular",["ui.router","LocalStorageModule"]).config(function(a,b){b.otherwise("/"),a.state("main",{url:"/",templateUrl:"src/views/main.html",controller:"mainCtrl as main"}).state("main.inmates",{url:"inmates",templateUrl:"src/views/inmates.html",controller:"inmatesCtrl as inmates"}).state("main.crimes",{url:"crimes",templateUrl:"src/views/crimes.html",controller:"crimesCtrl as crimes"}).state("main.manager",{url:"manager",templateUrl:"src/views/manager.html",controller:"managerCtrl as manager"})})}(),function(){angular.module("baseAngular").service("CrimesService",function(a){function b(a){g=a}function c(){return!!g&&g}function d(){var a=$.ajax({method:"GET",url:"https://inmatesearch.herokuapp.com/api/nc/durham/crimes",success:function(a){console.log("Success: getCrimes")},error:function(a){console.log("Error: getCrimes"),console.log(a)}});return a}function e(a){var b={query:{name:a.name},update:{name:a.name,bailable:a.bailable}},b=$.ajax({method:"PUT",url:"https://inmatesearch.herokuapp.com/api/nc/durham/crimes",data:b,success:function(a){console.log("Success: updateCrime")},error:function(a){console.log("Error: updateCrime"),console.log(a)}});return b}function f(a){var b=$.ajax({method:"POST",url:"https://inmatesearch.herokuapp.com/api/inmatemanager/crimes",data:a,success:function(a){console.log("Success: addCrime")},error:function(a){console.log("Error: addCrime"),console.log(a)}});return b}var g;return{getCrimes:d,addCrime:f,updateCrime:e,setCrimeList:b,getCrimeList:c}})}(),function(){angular.module("baseAngular").service("InmateService",function(a,b){function c(a){h=a}function d(){return!!h&&h}function e(){var a=$.ajax({method:"GET",url:"https://inmatesearch.herokuapp.com/api/nc/durham/inmates",success:function(a){console.log("Success: getInmates")},error:function(a){console.log("Error: getInmates"),console.log(a)}});return a}function f(a){var b=$.ajax({method:"POST",url:"https://inmatesearch.herokuapp.com/api/inmatemanager/inmates",data:a,success:function(a){console.log("Success: addInmate")},error:function(a){console.log("Error: addInmate"),console.log(a)}});return b}function g(a){var c=!0,d=b.getCrimeList();a.charges.forEach(function(a){d.forEach(function(b){a.description==b.name&&"No"==b.bailable&&(c=!1),"[N/A]"!=a.bondType&&"NO BOND"!=a.bondType&&"NB"!=a.bondType||(c=!1)})}),a.totalBailAmount<=2e3&&c?a.bailability="Yes":a.bailability="No"}var h;return{getInmates:e,addInmate:f,checkBailability:g,setInmateList:c,getInmateList:d}})}(),function(){angular.module("baseAngular").service("ManagerService",function(a){function b(){var a=$.ajax({method:"GET",url:"https://inmatesearch.herokuapp.com/api/nc/durham/inmates",success:function(a){console.log("Success: getInmates")},error:function(a){console.log("Error: getInmates"),console.log(a)}});return a}function c(a){var b=$.ajax({method:"POST",url:"https://inmatesearch.herokuapp.com/api/inmatemanager/inmates",data:a,success:function(a){console.log("Success: addInmate")},error:function(a){console.log("Error: addInmate"),console.log(a)}});return b}return{getInmates:b,addInmate:c}})}(),angular.module("baseAngular").service("UserService",function(a,b){function c(){return n}function d(){gapi.client.setApiKey(l),gapi.auth2.init({client_id:m,scope:"profile"}).then(function(){k=gapi.auth2.getAuthInstance(),k.isSignedIn.listen(e),e(k.isSignedIn.get())})}function e(a){a?($(".signInBtn").hide(),$(".signOutBtn").show(),$(".signInWelcome").show(),h()):($(".signInBtn").show(),$(".signOutBtn").hide(),$(".signInWelcome").hide(),o=!1)}function f(){k.signIn({prompt:"login"})}function g(){k.signOut()}function h(){var a=gapi.client.request({path:"https://people.googleapis.com/v1/people/me",method:"GET"});a.then(function(a){n.name=a.result.names[0].displayName,n.picture=a.result.photos[0].url,n.uid=k.currentUser.Ab.El,n.token=k.currentUser.Ab.Zi.access_token,o=!0})}function i(a){n.username=a,$.ajax({method:"POST",url:"https://forge-api.herokuapp.com/users/create",data:{username:n.username,uid:n.uid,token:n.token},success:function(a){n.id=a.id,PopupService.close()},error:function(a){PopupService.close(),PopupService.openTemp("fail-user-load"),g()}})}function j(a){return console.log(a),n.username=a,$.ajax({method:"PATCH",url:"https://forge-api.herokuapp.com/users/update",headers:{user_id:n.id,token:n.token},data:{username:a},success:function(a){return a},error:function(a){}})}var k,l="AIzaSyCnkQqRkK-S9tWGZkRnjNVeVGwYsAZG5D4",m="80279716609-tbtbobnu30bdoq56imdr0a9gncqcn4il.apps.googleusercontent.com",n={name:null,uid:null,token:null,username:null,picture:null,id:null,joined:null},o=!1;return gapi.load("client:auth2",d),{getUser:c,register:i,editUsername:j,signOut:g,signIn:f}}),angular.module("baseAngular").controller("crimesCtrl",function(a,b,c){var d=this;d.updateCrime=function(b){a.updateCrime(b).done(function(a){console.log("Received Response: "),console.log(a)})}}),angular.module("baseAngular").controller("inmatesCtrl",function(a,b,c){var d=this;d.searchChargesType="lessThan",d.searchBailType="lessThan",d.searchNumCharges,d.searchBailAmount,d.totalBailAmount=0,d.addInmate=function(b){a.addInmateToManager(b).done(function(a){console.log(a)})},d.searchCharges=function(a){return!d.searchNumCharges||("exact"==d.searchChargesType&&a.charges.length==d.searchNumCharges||("lessThan"==d.searchChargesType&&a.charges.length<=d.searchNumCharges||"greaterThan"==d.searchChargesType&&a.charges.length>=d.searchNumCharges))},d.searchTotalBail=function(a){return!d.searchBailAmount||("exact"==d.searchBailType&&a.totalBailAmount==d.searchBailAmount||("lessThan"==d.searchBailType&&a.totalBailAmount<=d.searchBailAmount||"greaterThan"==d.searchBailType&&a.totalBailAmount>=d.searchBailAmount))},d.getStats=function(){d.totalBailAmount=0,d.filterResults.forEach(function(a){d.totalBailAmount+=a.totalBailAmount})}}),angular.module("baseAngular").controller("mainCtrl",function(a,b,c,d){function e(){b.getCrimes().done(function(a){a.forEach(function(a){a.bailable&&"Maybe"!=a.bailable||(a.bailable="Null",m.updateCrime(a))}),b.setCrimeList(a),m.loadingCrimes=!1,m.loadingCrimes||m.loadingInmates||(m.loading=!1),m.crimeList=b.getCrimeList(),d.$apply()})}function f(){a.getInmates().done(function(b){b.forEach(function(b){a.checkBailability(b)}),a.setInmateList(b),m.loadingInmates=!1,m.loadingCrimes||m.loadingInmates||(m.loading=!1),m.inmateList=a.getInmateList(),d.$apply()})}function g(){return q}function h(){gapi.client.setApiKey(o),gapi.auth2.init({client_id:p,scope:"profile"}).then(function(){n=gapi.auth2.getAuthInstance(),n.isSignedIn.listen(i),i(n.isSignedIn.get())})}function i(a){a?l():(m.signedIn=!1,r=!1,d.$apply())}function j(){n.signIn({prompt:"login"})}function k(){n.signOut()}function l(){var a=gapi.client.request({path:"https://people.googleapis.com/v1/people/me",method:"GET"});a.then(function(a){q.name=a.result.names[0].displayName,q.picture=a.result.photos[0].url,q.uid=n.currentUser.Ab.El,q.token=n.currentUser.Ab.Zi.access_token,m.user=q,r=!0,m.signedIn=!0,d.$apply()})}var m=this;m.signedIn=!1,m.loading=!0,m.user=g(),m.crimeList=b.getCrimeList()||e(),m.inmateList=a.getInmateList()||f(),m.updateCrime=function(a){b.updateCrime(a).done(function(a){})},m.signIn=function(){j()},m.signOut=function(){k()};var n,o="AIzaSyCnkQqRkK-S9tWGZkRnjNVeVGwYsAZG5D4",p="80279716609-tbtbobnu30bdoq56imdr0a9gncqcn4il.apps.googleusercontent.com",q={name:null,uid:null,token:null,username:null,picture:null,id:null,joined:null},r=!1;gapi.load("client:auth2",h)}),angular.module("baseAngular").controller("managerCtrl",function(a,b,c){});