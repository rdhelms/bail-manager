!function(){"use strict";angular.module("inmateManager",["ui.router","LocalStorageModule"]).config(function(a,b){b.otherwise("/"),a.state("main",{url:"/",templateUrl:"src/views/main.html",controller:"mainCtrl as main"}).state("main.inmates",{url:"inmates",templateUrl:"src/views/inmates.html",controller:"inmatesCtrl as inmates"}).state("main.crimes",{url:"crimes",templateUrl:"src/views/crimes.html",controller:"crimesCtrl as crimes"}).state("main.manager",{url:"manager",templateUrl:"src/views/manager.html",controller:"managerCtrl as manager"})})}(),function(){angular.module("inmateManager").service("CrimesService",function(a){function b(a){g=a}function c(){return g?g:[]}function d(){var a=$.ajax({method:"GET",url:"https://inmatesearch.herokuapp.com/api/nc/durham/crimes",success:function(a){console.log("Success: getCrimes")},error:function(a){console.log("Error: getCrimes"),console.log(a)}});return a}function e(a){var b={query:{name:a.name},update:{name:a.name,bailable:a.bailable}},b=$.ajax({method:"PUT",url:"https://inmatesearch.herokuapp.com/api/nc/durham/crimes",data:b,success:function(a){console.log("Success: updateCrime")},error:function(a){console.log("Error: updateCrime"),console.log(a)}});return b}function f(a){var b=$.ajax({method:"POST",url:"https://inmatesearch.herokuapp.com/api/inmatemanager/crimes",data:a,success:function(a){console.log("Success: addCrime")},error:function(a){console.log("Error: addCrime"),console.log(a)}});return b}var g;return{getCrimes:d,addCrime:f,updateCrime:e,setCrimeList:b,getCrimeList:c}})}(),function(){angular.module("inmateManager").service("InmateService",function(a,b){function c(a){h=a}function d(){return h?h:[]}function e(){var a=$.ajax({method:"GET",url:"https://inmatesearch.herokuapp.com/api/nc/durham/inmates",success:function(a){console.log("Success: getInmates")},error:function(a){console.log("Error: getInmates"),console.log(a)}});return a}function f(a){var b=$.ajax({method:"POST",url:"https://inmatesearch.herokuapp.com/api/inmatemanager/inmates",data:a,success:function(a){console.log("Success: addInmate")},error:function(a){console.log("Error: addInmate"),console.log(a)}});return b}function g(a){var c=!0,d=b.getCrimeList();a.charges.forEach(function(a){d.forEach(function(b){a.description==b.name&&"No"==b.bailable&&(c=!1),"[N/A]"!=a.bondType&&"NO BOND"!=a.bondType&&"NB"!=a.bondType||(c=!1)})}),a.totalBailAmount<=2e3&&c?a.bailability="Yes":a.bailability="No"}var h;return{getInmates:e,addInmate:f,checkBailability:g,setInmateList:c,getInmateList:d}})}(),function(){angular.module("inmateManager").service("ManagerService",function(a){function b(){var a=$.ajax({method:"GET",url:"https://inmatesearch.herokuapp.com/api/nc/durham/inmates",success:function(a){console.log("Success: getInmates")},error:function(a){console.log("Error: getInmates"),console.log(a)}});return a}function c(a){var b=$.ajax({method:"POST",url:"https://inmatesearch.herokuapp.com/api/inmatemanager/inmates",data:a,success:function(a){console.log("Success: addInmate")},error:function(a){console.log("Error: addInmate"),console.log(a)}});return b}return{getInmates:b,addInmate:c}})}(),function(){angular.module("inmateManager").service("UserService",function(a){function b(a){var b=$.ajax({method:"POST",url:"https://inmatesearch.herokuapp.com/api/nc/durham/users",data:a});return b}return{signInUser:b}})}(),angular.module("inmateManager").controller("crimesCtrl",function(a,b,c){var d=this;d.updateCrime=function(b){a.updateCrime(b).done(function(a){console.log("Received Response: "),console.log(a)})}}),angular.module("inmateManager").controller("inmatesCtrl",function(a,b,c){var d=this;d.searchChargesType="lessThan",d.searchBailType="lessThan",d.searchNumCharges,d.searchBailAmount,d.totalBailAmount=0,d.addInmate=function(b){a.addInmateToManager(b).done(function(a){console.log(a)})},d.searchCharges=function(a){return!d.searchNumCharges||("exact"==d.searchChargesType&&a.charges.length==d.searchNumCharges||("lessThan"==d.searchChargesType&&a.charges.length<=d.searchNumCharges||"greaterThan"==d.searchChargesType&&a.charges.length>=d.searchNumCharges))},d.searchTotalBail=function(a){return!d.searchBailAmount||("exact"==d.searchBailType&&a.totalBailAmount==d.searchBailAmount||("lessThan"==d.searchBailType&&a.totalBailAmount<=d.searchBailAmount||"greaterThan"==d.searchBailType&&a.totalBailAmount>=d.searchBailAmount))},d.getStats=function(){d.totalBailAmount=0,d.filterResults.forEach(function(a){d.totalBailAmount+=a.totalBailAmount})}}),angular.module("inmateManager").controller("mainCtrl",function(a,b,c,d,e){function f(){b.getCrimes().done(function(a){a.forEach(function(a){a.bailable&&"Maybe"!=a.bailable||(a.bailable="Null",o.updateCrime(a))}),b.setCrimeList(a),o.loadingCrimes=!1,o.loadingCrimes||o.loadingInmates||(o.loading=!1),o.crimeList=b.getCrimeList(),e.$apply()})}function g(){a.getInmates().done(function(b){b.forEach(function(b){a.checkBailability(b)}),a.setInmateList(b),o.loadingInmates=!1,o.loadingCrimes||o.loadingInmates||(o.loading=!1),o.inmateList=a.getInmateList(),e.$apply()})}function h(a){c.signInUser(a).done(function(a){var b=a.result.value;console.log("Registered User:",b),b.super&&(f(),g(),o.validUser=!0),o.signedIn=!0,o.user=b,e.$apply()}).fail(function(a){console.log("Error getting Registered User",a),o.signOut()})}function i(){return s}function j(){gapi.client.setApiKey(q),gapi.auth2.init({client_id:r,scope:"profile"}).then(function(){p=gapi.auth2.getAuthInstance(),p.isSignedIn.listen(k),k(p.isSignedIn.get())})}function k(a){a?n():(o.signedIn=!1,e.$apply())}function l(){p.signIn({prompt:"login"})}function m(){p.signOut()}function n(){var a=gapi.client.request({path:"https://people.googleapis.com/v1/people/me",method:"GET"});a.then(function(a){console.log("Google User info:",a),console.log("Google auth info:",p.currentUser),s.name=a.result.names[0].displayName,s.picture=a.result.photos[0].url,s.uid=p.currentUser.Ab.El,s.token=p.currentUser.Ab.Zi.access_token,h(s)})}var o=this;o.signedIn=!1,o.loading=!0,o.user=i(),o.validUser=!1,o.crimeList=b.getCrimeList(),o.inmateList=a.getInmateList(),o.updateCrime=function(a){b.updateCrime(a).done(function(a){})},o.signIn=function(){l()},o.signOut=function(){o.validUser=!1,m()};var p,q="AIzaSyCnkQqRkK-S9tWGZkRnjNVeVGwYsAZG5D4",r="80279716609-tbtbobnu30bdoq56imdr0a9gncqcn4il.apps.googleusercontent.com",s={name:null,uid:null,token:null,picture:null};gapi.load("client:auth2",j)}),angular.module("inmateManager").controller("managerCtrl",function(a,b,c){});